import{c as j,t as z,n as N,m as O,d as K,r as se,a0 as L,aj as ce,u as ue,l as d,W as U,V as S,az as re,a1 as q,aA as ve,aB as fe,aC as de,aw as he,b as C,aD as V,ac as F,ak as me,am as ge,an as we,aE as k,al as _,w as G,k as ye}from"./index-2f00049f.js";const[J,I]=j("swipe"),be={loop:z,width:N,height:N,vertical:Boolean,autoplay:O(0),duration:O(500),touchable:z,lazyRender:Boolean,initialSwipe:O(0),indicatorColor:String,showIndicators:z,stopPropagation:z},Q=Symbol(J);var pe=K({name:J,props:be,emits:["change"],setup(a,{emit:P,slots:h}){const u=se(),e=L({rect:null,width:0,height:0,offset:0,active:0,swiping:!1}),s=ce(),{children:m,linkChildren:M}=ue(Q),i=d(()=>m.length),n=d(()=>e[a.vertical?"height":"width"]),r=d(()=>a.vertical?s.deltaY.value:s.deltaX.value),f=d(()=>e.rect?(a.vertical?e.rect.height:e.rect.width)-n.value*i.value:0),$=d(()=>Math.ceil(Math.abs(f.value)/n.value)),b=d(()=>i.value*n.value),w=d(()=>(e.active+i.value)%i.value),B=d(()=>{const t=a.vertical?"vertical":"horizontal";return s.direction.value===t}),Z=d(()=>{const t={transitionDuration:`${e.swiping?0:a.duration}ms`,transform:`translate${a.vertical?"Y":"X"}(${e.offset}px)`};if(n.value){const l=a.vertical?"height":"width",o=a.vertical?"width":"height";t[l]=`${b.value}px`,t[o]=a[o]?`${a[o]}px`:""}return t}),ee=t=>{const{active:l}=e;return t?a.loop?_(l+t,-1,i.value):_(l+t,0,$.value):l},E=(t,l=0)=>{let o=t*n.value;a.loop||(o=Math.min(o,-f.value));let v=l-o;return a.loop||(v=_(v,f.value,0)),v},g=({pace:t=0,offset:l=0,emitChange:o})=>{if(i.value<=1)return;const{active:v}=e,c=ee(t),T=E(c,l);if(a.loop){if(m[0]&&T!==f.value){const D=T<f.value;m[0].setOffset(D?b.value:0)}if(m[i.value-1]&&T!==0){const D=T>0;m[i.value-1].setOffset(D?-b.value:0)}}e.active=c,e.offset=T,o&&c!==v&&P("change",w.value)},A=()=>{e.swiping=!0,e.active<=-1?g({pace:i.value}):e.active>=i.value&&g({pace:-i.value})},te=()=>{A(),s.reset(),k(()=>{e.swiping=!1,g({pace:-1,emitChange:!0})})},R=()=>{A(),s.reset(),k(()=>{e.swiping=!1,g({pace:1,emitChange:!0})})};let Y;const p=()=>clearTimeout(Y),x=()=>{p(),a.autoplay>0&&i.value>1&&(Y=setTimeout(()=>{R(),x()},+a.autoplay))},y=(t=+a.initialSwipe)=>{if(!u.value)return;const l=()=>{var o,v;if(!V(u)){const c={width:u.value.offsetWidth,height:u.value.offsetHeight};e.rect=c,e.width=+((o=a.width)!=null?o:c.width),e.height=+((v=a.height)!=null?v:c.height)}i.value&&(t=Math.min(i.value-1,t)),e.active=t,e.swiping=!0,e.offset=E(t),m.forEach(c=>{c.setOffset(0)}),x()};V(u)?F().then(l):l()},W=()=>y(e.active);let X;const ae=t=>{a.touchable&&(s.start(t),X=Date.now(),p(),A())},ie=t=>{a.touchable&&e.swiping&&(s.move(t),B.value&&(me(t,a.stopPropagation),g({offset:r.value})))},H=()=>{if(!a.touchable||!e.swiping)return;const t=Date.now()-X,l=r.value/t;if((Math.abs(l)>.25||Math.abs(r.value)>n.value/2)&&B.value){const v=a.vertical?s.offsetY.value:s.offsetX.value;let c=0;a.loop?c=v>0?r.value>0?-1:1:0:c=-Math[r.value>0?"ceil":"floor"](r.value/n.value),g({pace:c,emitChange:!0})}else r.value&&g({pace:0});e.swiping=!1,x()},ne=(t,l={})=>{A(),s.reset(),k(()=>{let o;a.loop&&t===i.value?o=e.active===0?0:t:o=t%i.value,l.immediate?k(()=>{e.swiping=!1}):e.swiping=!1,g({pace:o-e.active,emitChange:!0})})},oe=(t,l)=>{const o=l===w.value,v=o?{backgroundColor:a.indicatorColor}:void 0;return C("i",{style:v,class:I("indicator",{active:o})},null)},le=()=>{if(h.indicator)return h.indicator({active:w.value,total:i.value});if(a.showIndicators&&i.value>1)return C("div",{class:I("indicators",{vertical:a.vertical})},[Array(i.value).fill("").map(oe)])};return U({prev:te,next:R,state:e,resize:W,swipeTo:ne}),M({size:n,props:a,count:i,activeIndicator:w}),S(()=>a.initialSwipe,t=>y(+t)),S(i,()=>y(e.active)),S(()=>a.autoplay,x),S([ge,we],W),S(re(),t=>{t==="visible"?x():p()}),q(y),ve(()=>y(e.active)),fe(()=>y(e.active)),de(p),he(p),()=>{var t;return C("div",{ref:u,class:I()},[C("div",{style:Z.value,class:I("track",{vertical:a.vertical}),onTouchstart:ae,onTouchmove:ie,onTouchend:H,onTouchcancel:H},[(t=h.default)==null?void 0:t.call(h)]),le()])}}});const Pe=G(pe),[xe,Te]=j("swipe-item");var Se=K({name:xe,setup(a,{slots:P}){let h;const u=L({offset:0,inited:!1,mounted:!1}),{parent:e,index:s}=ye(Q);if(!e)return;const m=d(()=>{const n={},{vertical:r}=e.props;return e.size.value&&(n[r?"height":"width"]=`${e.size.value}px`),u.offset&&(n.transform=`translate${r?"Y":"X"}(${u.offset}px)`),n}),M=d(()=>{const{loop:n,lazyRender:r}=e.props;if(!r||h)return!0;if(!u.mounted)return!1;const f=e.activeIndicator.value,$=e.count.value-1,b=f===0&&n?$:f-1,w=f===$&&n?0:f+1;return h=s.value===f||s.value===b||s.value===w,h}),i=n=>{u.offset=n};return q(()=>{F(()=>{u.mounted=!0})}),U({setOffset:i}),()=>{var n;return C("div",{class:Te(),style:m.value},[M.value?(n=P.default)==null?void 0:n.call(P):null])}}});const $e=G(Se);export{Pe as S,$e as a};
